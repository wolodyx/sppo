# Установка программного обеспечения

Новый шкаф в квартиру привозят в плотно упакованной и затянутой хомутами картонной коробке.
Чтобы коробка стала шкафом, ее содержимое надо распаковать и собрать по приложенной внутри инструкции.
Хозяин квартиры может сделать это самостоятельно или попросить сборщиков.
Также и дистрибутив требует подготовительных действий по превращению его в готовую к запуску программу.
Эти действия называются установкой программы.

Развернуть программу на компьютере пользователь может самостоятельно, используя архиватор, компилятор, систему сборки программы.
Или же сделать это через специализированные инструменты — установщик и система управления пакетами.

**Без установки**.
В зависимости от программы, установка имеет разную степень сложности.
Для некоторых программ достаточно копирования файлов.
Если это простая программа, состоящая из самодостаточных файлов.
Или же переносимое приложение, которое разработчик предварительно изолировал от внешних компонент, поместив все нужное в каталог программы.
Для запуска веб-приложения не нужны никакие подготовительные действия.
Достаточно запустить веб-браузер и указать адрес сайта.

**Управление зависимостями**.
Видимая простота может оказаться ложной при встрече с реальностью.
Разработанная для Windows простая программа на C++ вдруг откажется работать на компьютере, где не установлены инструменты разработки.
Программа компоновалась диначиески с библиотекой времени исполнения — RTL.
RTL предоставляется средой разработки и не входит в состав ОС Windows.
Это приводит к одной из задачи установки — управление зависимостями.
Установка программы предваряется установкой компонент, от которых она зависит.

**Стандартный процесс установки**.
Процент людей, пользующихся компьютерами, подходит к значению 100.
Мало кто из них относится к специалистам по ПО.
Поэтому процесс установки должен быть как можно простым.
Это достигается за счет иднообразного алгоритма установки на платформах.
Наиболее проста установка в мобильных устройствах.
Чуть сложнее и требует внимания установки на персональных компьютерах.
Сборка и установка программ из исходных кодов в UNIX-подобных ОС сложна и требует изучения материала.

Мастер инсталляции — часть графического интерфейса, направляющая шаг за шагом действия пользователя при установке ПО.

Ограничение установки или запуска.
Копирование цифровых данных не требует усилий и специальных средства.
Чтобы остановить нелегальное использование ПО, разработчики придумывают разные способы ограничения установки и запуска — регистрационные и аппаратные ключи, сервера лицензий, привязка ПО к пользователю, машине или платформе.
Это усложняет процесс установки.
К тому же увеличивают стоимостью программы и не для всех оправдано.
(Про защиту игр в XBox, Steam).

Обобщенный алгоритм установки программы состоит из следующих шагов:
1. Проверка целостности дистрибутива.
2. Извлечение данных из дистрибутива.
3. Согласие с лицензией.
4. Проверка системных требований на соответствие.
5. Проверка версий установленного ПО.
6. Опрос пользователя.
7. Создание/обновление файлов и каталогов ПО.
8. Добавление настроек — файлов настроек, веток реестра, системных переменных.
9. Настройка доступа к программе.
10. Активация ПО.

Продолжим аналогию со шкафом.
Покупатель шкафа оценивает внешний вид принесенной коробки — не повреждена ли упаковка, целы ли углы, не попала ли вода или грязь.
Первая процедура при установке программы — это проверка целостности дистрибутива.
При хранении или передаче, дистрибутив мог измениться — случайно или преднамеренно.
В результате установки с поврежденного дистрибутива, программа может быть нерабочей или опасной для системы.
Целостность дистрибутива проверяют двумя способами — сравнением контрольных сумм или проверкой цифрового сертификата.

Разработчик программы в дополнение к файлу с дистрибутивом предоставляет файл с контрольной суммой.
После загрузки, пользователь вычисляет контрольную сумму дистрибутива и сравнивает ее с предоставленной суммой в файле.
Если они совпадают, то считается, что внутреннее содержимое дистрибутива не нарушено.

Содержимое дистрибутива извлекается во временный каталог.

Программы охраняются законом об авторском праве.
Если дистрибутив содержит исходные коды программы, то в корневом каталоге помещают файл LICENSE с условиями использования.
Если в коде нет упоминания о лицензии, то такая программа не может быть использована.

При запуске установки в первую очередь появляется условия использования программы, в котором прописаны ответственности пользователя и разработчика, условия, на которые соглашается пользователь, устанавливая эту программу.
По-другому, условиях лицензии, называют пользовательским соглашением.
Согласие с ними приведет к продолжению установки.

Программы, выполняющие сложные вычисления, требуют соответствующее им аппаратное обеспечение.
Системные требования программы — это минимальные требования к оборудованию, при которых программа будет выполнять свои функции и не нагружать систему.
Сюда входят тип и частота процессора, тип ОС, объем ОЗУ, объем свободного пространства на диске, размер и разрешение экрана, связь с интернет, дополнительные порты ввода-вывода, дополнительная графическая карта.
Они указываются на коробке с диском программы, на официальном сайте.
Системные требования обычно указываются на коробке с программой или на сайте разработчика.
Программа проверяет выполнение требований и может отказаться от установке при их несоблюдении.

Устанавливаемая программа может потребовать установку зависимостей, без которых она не будет корректно работать.
Пользователь или сам устанавливает эти зависимости, или за это берется система.

Сборка программы в UNIX-подобных ОС требует установки в системе компилятора, библиотеки Си и инструментов сборки.
Их нужно предварительно установить.
С случае с ОС Debian, они включены в пакет build-essential.
В других системах их нужно установить отдельно.

Если при установке окажется, что программа ранее устанавливалась, то у пользователя спросят о дальнейшем поведении — нужно обновить, перезаписать или поставить рядом.
Особенно это актуально для конфигурационных файлов.
Их лучше не переписывать.

## Размещение ПО в файловой системе

ПО состоит из следующих частей:
* исполняемых файлов;
* файлов настроек;
* документации;
* пользовательских данных, создаваемых программой;
* временных файлов.

Каждая ОС предоставляет свои правила и рекомендации по размещению файлов программы в файловой системе.
Рассмотрим их подробнее.

**Структура файловой системы**.
В UNIX-подобных ОС структура каталогов и их назначения приведены к общему виду через стандарт FHS.

Структура каталогов и дисков в ОС Windows не стандартизированы.
Диск, на котором располагаются системные каталоги и файлы, называют системным диском.
В большинстве случаев его обозначают именем “С:”.
Но это не всегда верно.
Чтобы определить точное имя системного диска, используется переменная среды SYSTEMDRIVE.

**Скрытые файлы**.
Файлы и каталоги могут быть скрыты от стандартных средств просмотра файловой системы.
Это сделано для того, чтобы не удалить их случайно, например, при множественном выделении.
Обычно скрывают файлы настроек и временные файлы.
Для сокрытия файла в ОС Windows используют атрибут файла Hidden.
В UNIX файл или каталог, имеющий в начале названия точку, считается скрытым и по умолчанию не отображается при просмотре стандартными средствами.

Системные и пользовательские файлы.
Файлы в файловой системе ОС можно поделить на две части — это системные и пользовательские.
Системный файл — это файл, необходимый для функционирования ОС.
Системный каталог — это каталог с системными файлами.
Обычный пользователь не имеет прав для внесения изменений в такие файлы и каталоги.
Для внесения изменений в системные объекты нужны права администратора.
В пользовательских каталогах и файлах располагаются данные пользователя.
Их можно добавлять, удалять и редактировать свободно.

**Расположение исполняемых файлов**.
Исполняемые файлы и библиотеки программ создаются в процессе установки и с этого момента больше не меняются.
Они могут быть перезаписаны при следующей установке для обновления программы.
Но запись в них другое время можно рассматривать как нарушение безопасности системы — добавление зловредного кода.
Поэтому исполняемые файлы записываются в системные каталоги.
Из-за этого установка программы требует привилегии суперпользователя.

В ОС Windows исполняемые и неизмененные файлы программы располагаются на системном диске в каталогах:
* “Program Files” — каталог с установленными приложениями;
* “Program Files (x86)” — каталог с установленными 32-разрядными приложениями в 64-разрядной системе.

Исполняемые файлы в UNIX располагаются в каталогах /bin, /usr/bin, /opt.
Разделяемые библиотеки помещаются в каталоги /lib, /usr/lib.

**Расположение файлов настроек**.
Настройки программы делят на два уровня — настройки для конкретного пользователя и общесистемные.
Общесистемные настройки относятся ко всем пользователям.

Файлы с настройками хранятся отдельно от исполняемых файлов, так как в них предполагается вносить изменения.
Пользовательские настройки располагаются в домашнем каталоге пользователя.
Для защиты от случайного удаления, их файлы скрыты от стандартных средств просмотра.

Общесистемные настройки в UNIX хранятся в виде файлов в каталогах /etc, /usr/etc.

До Windows 7 общесистемные настройки программ хранились в каталоге “Program Files” вместе с исполняемыми файлами или же в домашнем каталоге специального пользователя “All Users” (C:\Users\All Users).
Начиная с Windows 7 для хранения данных программ, общих для всех пользователей, используют каталог “C:\ProgramData”.

В Windows настройки программ также могут храниться в системном реестре.
Системный реестр — это иерархическая база данных параметров и настроек ОС Windows и пользовательских приложений.
Он предоставляет единый способ хранения, доступа и изменения настроек.

**Временные файлы**.
Каталог с временными файлами пользовательских приложений определяется в %userprofile%\AppData\Local\Temp.
Приложение в Windows для каждого пользователя может создавать свои временные файлы.

**Расположение пользовательских данных**.
Пользовательские данные сохраняются в домашнем каталоге пользователя.

**Настройка системы для запуска программы**.
Программа в Windows запускается через ярлык.
Ярлык — это файл, указывающий на объект (файл, программу или каталог).
Вновь установленные программы создают ярлыки для исполняемого файла на рабочем столе, панели инструментов, в меню Пуск.

С рабочим столом ассоциирован специальный каталог — %userprofile%\Desktop\.

В UNIX исполняемые файлы размещаются в стандартных каталогах /bin, /usr/bin, /home/user_name/bin.
Программа, расположенная в этих каталогах, может быть запущена по имени, без указания абсолютного пути.
Система выполнит поиск в каталогах, указанных в системной переменной PATH и запустит первую найденную программу.

**Незатронутые вопросы**.
Одновременная установка программы на несколько компьютеров.
После установки возникнут вопросы удаления или обновления ПО.
Чистая установка.
Слежение за версиями.
Отмена установки (откат).
Настраиваемая установка.
Дополнительное (навязанное) ПО.
